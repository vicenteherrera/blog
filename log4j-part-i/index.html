<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Log4j 2 vulnerabilities, part I: History" /><meta property="og:locale" content="en" /><meta name="description" content="December 9th, 2021 a critical update was published for Log4jÂ 2. Its massive use has caused a huge impact all over the Internet, but the story start many years before." /><meta property="og:description" content="December 9th, 2021 a critical update was published for Log4jÂ 2. Its massive use has caused a huge impact all over the Internet, but the story start many years before." /><link rel="canonical" href="https://vicenteherrera.com/blog/log4j-part-i/" /><meta property="og:url" content="https://vicenteherrera.com/blog/log4j-part-i/" /><meta property="og:site_name" content="The Vlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-17T17:30:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Log4j 2 vulnerabilities, part I: History" /><meta name="twitter:site" content="@v1z3n" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-01T13:16:51+02:00","datePublished":"2021-12-17T17:30:00+01:00","description":"December 9th, 2021 a critical update was published for Log4jÂ 2. Its massive use has caused a huge impact all over the Internet, but the story start many years before.","headline":"Log4j 2 vulnerabilities, part I: History","mainEntityOfPage":{"@type":"WebPage","@id":"https://vicenteherrera.com/blog/log4j-part-i/"},"url":"https://vicenteherrera.com/blog/log4j-part-i/"}</script><meta name="twitter:description" content="December 9th, 2021 a critical update was published for Log4jÂ 2. Its massive use has caused a huge impact all over the Internet, but the story start many years before. "><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://vicenteherrera.com/blog/images/featured/minecraft_log4j.png"><title>Log4j 2 vulnerabilities, part I: History | The Vlog</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="The Vlog"><meta name="application-name" content="The Vlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" alt="avatar" class="mx-auto"> <img src="/blog/v.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/blog/">The Vlog</a></div><div class="site-subtitle font-italic">Vicente's blog about security and personal stuff</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/vicenteherrera" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/v1z3n" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/vicenteherrera" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/blog/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog/"> Home </a> </span> <span>Log4j 2 vulnerabilities, part I: History</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Log4j 2 vulnerabilities, part I: History</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Vicente Herrera </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Dec 17, 2021, 5:30 PM +0100" >Dec 17, 2021<i class="unloaded">2021-12-17T17:30:00+01:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Jul 1, 2023, 1:16 PM +0200" >Jul 1<i class="unloaded">2023-07-01T13:16:51+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3642 words">20 min read</span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1893 758'%3E%3C/svg%3E" data-proofer-ignore data-src="/blog/images/featured/minecraft_log4j.png" class="preview-img" alt="Same day vulnerability is disclosed, Minecraft demonstrates vulnerable by sending a message in the chat window" width="1893" height="758"><p>On the 9th of December 2021, a critical update because a vulnerability was published for the popular open source Log4jÂ 2 library. The next day it was classified as <strong>CVEâ€‘2021â€‘44228</strong>. Some people started calling it â€œ<strong>log4shell</strong>â€, as it allowed very easily to do a <a href="/blog/intro-mitre-attack/#tactics">remote code execution</a> attack. Days later several new vulnerability reports and patches would be published for this and related projects.</p><p>The implications are so huge that I had to break this article into several parts. In this first one, Iâ€™ll center on my personal investigation of the history of the library, its vulnerabilities, software vendor response, and who are its maintainers (support them!).</p><p>To learn more about Log4j and vulnerabilities, donâ€™t forget to visit also my other posts:</p><ul><li><a href="/blog/log4j-part-i/" target="_blank">Part I: History</a> (this post)<li><a href="/blog/log4j-part-ii/">Part II: Kubernetes POC</a><li><a href="/blog/log4j-part-iii/">Part III: Prevention, mitigation, and fixing</a></ul><p>In this post I explain in my own words how the vulnerability works, and presents details of a Kubernetes <em>proof of concept</em> created by me. On a third part (work in progress), I will analyze security measures, fixes and mitigations.</p><p class="alert alert-warning"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> If you are worried about your services in production, stop reading here and update all libraries in your code, the third-party software you use, and ensure your cloud services has not been compromised.</p><h2 id="what-is-log4j-2">What is Log4j 2?</h2><p><a href="https://logging.apache.org/log4j/2.x" target="_blank">Apache Log4j 2</a> is a very popular open source Java library used to manage logging messages.</p><p>It is included in several frameworks like <a href="https://druid.apache.org/docs/latest/configuration/logging.html" target="_blank">Apache Druid</a>, <a href="https://flink.apache.org/2021/12/10/log4j-cve.html" target="_blank">Apache Flink</a>, <a href="https://solr.apache.org/guide/6_6/configuring-logging.html" target="_blank">Apache Solr</a>, <a href="https://spark.apache.org/docs/2.4.2/configuration.html#configuring-logging" target="_blank">Apache Spark</a>, <a href="https://struts.apache.org/announce-2021#a20211212-2" target="_blank">Apache Struts 2</a>, and <a href="https://tomcat.apache.org/tomcat-8.0-doc/logging.html" target="_blank">Apache Tomcat</a> (although that doesnâ€™t mean directly that they are vulnerable, read more about this in part II).</p><p>The extent of use of this library was so huge that a whole snowball of updates and patches took over the Internet.</p><div class="embed-responsive embed-responsive-16by9"> <iframe width="560" height="315" src="https://www.youtube.com/embed/7qoPDq41xhQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p><em>Same day vulnerability is disclosed, <a href="https://twitter.com/_JohnHammond/status/1469255402290401285/photo/1" target="_blank">Minecraft demonstrates vulnerable by sending a message in the chat window</a></em></p><h2 id="history">History</h2><p>A 0-day refers to a vulnerability that was not publicly known before. It may be zero for you and me, but being wildly exploited in secret. To put things in context, letâ€™s start this story at the beginning.</p><h3 id="year-2009">2009 (11 years earlier)</h3><p>Dissatisfied by Log4j version 1 and other equivalent libraries, <strong>Ralph Goers</strong> starts working on Log4j version 2 for the first time among the Apache foundation. <a href="https://www.ralphgoers.com/post/why-was-log4j-2-created" target="_blank">You can read details about this in his blog post â€œWhy was Log4jÂ 2 created?â€</a>. It will take years for the developers to consider releasing a stable version.</p><h3 id="year-2013">2013 (8 years earlier)</h3><p>ğŸ“…<strong>2013 September 14</strong>: <a href="https://logging.apache.org/log4j/2.x/changes-report.html#a2.0-beta9" target="_blank">Log4J 2.0-beta9 is released</a>, the first version that years later will be reported as vulnerable.</p><h3 id="year-2014">2014 (7 years earlier)</h3><p>ğŸ“…<strong>2014 July 12</strong>: <a href="https://logging.apache.org/log4j/2.x/changes-report.html#a2.0" target="_blank">Log4j 2.0 is published</a>, first version not alpha or beta, 5 years after the project started.</p><h3 id="year-2015">2015 (6 years earlier)</h3><p>ğŸ“…<strong>2015 October 21</strong>: A related <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-4902" target="_blank">CVEâ€‘2015â€‘4902</a> gets published with the description</p><blockquote class="quote"><p>â€œUnspecified vulnerability in Oracle Java SE 6u101, 7u85, and 8u60 allows remote attackers to affect integrity via unknown vectors related to Deployment.â€</p></blockquote><p>Many â€œunspecifiedâ€ and â€œunknownsâ€ for a description. <a href="https://twitter.com/adulau/status/1469959657049538561?s=20" target="_blank">It could be argued that not specifying the description of the vulnerability shouldnâ€™t be allowed for a complete CVE report</a>.</p><p><img data-proofer-ignore data-src="/blog/images/cve_unspecified.png" alt="Chart of word occurrence in CVE, unspecified appears 15000 times" title="Chart of word occurrence in CVE, unspecified appears 15000 times" /> <em>Source: <a href="https://twitter.com/adulau/status/1469959657049538561?s=20" target="_blank">Alexandre Dulaunoy</a> <a href="http://www.foo.be/cve/" target="_blank">2013 analysis of CVEs</a> (<a href="https://github.com/cve-search/cve-search" target="_blank">GitHub repo</a>)</em></p><p>The same day, you can read on <a href="https://www.itpro.com/security/25469/oracle-fixes-vulnerability-used-in-nato-and-white-house-hacks" target="_blank">ITPro website news</a> (this is a summary):</p><blockquote class="quote"><p>Oracle has patched up a flaw in Java that allowed hackers to breach targets such as <strong>NATO</strong> and the <strong>White House</strong> in an operation known as <strong>Pawn Storm</strong>. The vulnerability was used in attacks on web assets belonging the military organisation as well as a number of prominent companies, according to Trend Micro threat analyst Jack Tang. <br /> The flaw in question (CVEâ€‘2015â€‘4902) managed to evade Javaâ€™s Click-to-Play protection, which requires the user to click the space where the Java app would normally be displayed before it is executed. In effect, it asks the user if they are really sure they want to run any Java code. <br /> Bypassing click-to-play protection allows for malicious Java code to run without any alert windows being shown. To mount an attack, a hacker adds the HTML code to a malicious web site and then creates a RMI registry server which has a public IP address as well as creating another web server to hold the malicious Java code, which also has a public IP address.</p></blockquote><h3 id="year-2016">2016 (5 years earlier)</h3><p>ğŸ“…<strong>2016 August 3</strong>: At <a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE.pdf" target="_blank">BlackHat USA 2016, a presentation</a> by Alvaro MuÃ±oz and Oleksandr Mirosh from HP Enterprise Fortinet, shows how a combination of JNDI injection and LDAP entry poisoning could be used to make <a href="/blog/intro-mitre-attack/#tactics">remote code execution</a> possible, as was described in CVEâ€‘2015â€‘4902 the previous year. These are the same kind of steps involved in exploiting the later discovered Log4jÂ 2 vulnerability.</p><div class="embed-responsive embed-responsive-16by9"> <iframe width="560" height="315" src="https://www.youtube.com/embed/Y8a5nB-vy78?start=1529" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><h3 id="year-2017">2017 (4 years earlier)</h3><p>ğŸ“…<strong>2017 January 17</strong>: Oracle updates Java to version <a href="https://www.oracle.com/java/technologies/javase/8u121-relnotes.html" target="_blank">8u121</a>. Adds codebase restrictions to RMI when using JNDI for remote object lookup, where <code class="language-plaintext highlighter-rouge">classFactoryLocation</code> field is not used for deserialization any more. But LDAP protocol still executes it, and <code class="language-plaintext highlighter-rouge">javaFactory</code> also is still usable to use for RCE on both RMI and LDAP, making both vulnerable to this day.</p><p>ğŸ“…<strong>2017 March 7</strong>: A new vulnerability is discovered, unrelated to Log4j, but on the also very popular open source framework, Apache Struts. A situation where many companies use it and have to patch it develops, similar to what has happened with Log4jÂ 2.</p><p>ğŸ“…<strong>2017 March 10</strong>: Reports of hacking groups start looking for systems using Struts that are not updated with a fix.</p><p>ğŸ“…<strong>2017 May 12</strong>: <a href="https://en.wikipedia.org/wiki/2017_Equifax_data_breach#Data_breach" target="_blank">Equifax is hit very hard by a data breach, the biggest known to that date</a> because of a vulnerable Apache Struts. Some companies learn they canâ€™t leave security and updating as a second thought. Othersâ€¦ donâ€™t learn it.</p><h3 id="year-2018">2018 (3 years earlier)</h3><p>ğŸ“…<strong>2018 October 16</strong>: Oracle updates Java to version <a href="https://www.oracle.com/java/technologies/javase/8u191-relnotes.html">8u191</a>. When using JNDI for remote object lookup, the same <code class="language-plaintext highlighter-rouge">classFactoryLocation</code> restriction that was added to RMI two years ago is also added to LDAP. But <code class="language-plaintext highlighter-rouge">javaFactory</code> still usable on both RMI and LDAP for <em>remote code execution</em> to this day, being a key element for the future Log4jÂ 2 vulnerability to succeed.</p><h3 id="year-2021">2021</h3><p>ğŸ“…<strong>2021 October 10</strong>: Jfrog reserves ID <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42392" target="_blank">CVEâ€‘2021â€‘42392</a> that might be for a specific issue or a block or issues. It will not be until <a href="https://threatpost.com/log4j-related-flaw-h2-database/177448/" target="_blank">January 6th</a> it will be used for a vulnerability they have discovered on the H2 database (more on this later).</p><p>ğŸ“…<strong>2021 November 24</strong>: <a href="https://www.bloomberg.com/news/articles/2021-12-13/how-apache-raced-to-fix-a-potentially-disastrous-software-flaw" target="_blank">Chen Zhaojun of Alibaba privately reports the Log4jÂ 2 vulnerability</a> to the Apache team.</p><p>ğŸ“…<strong>2021 November 30</strong>: A pull request by Ralph Goers (original Log4jÂ 2 creator) is opened in the <a href="https://github.com/apache/logging-log4j2/pull/608" target="_blank">Log4j GitHub repository</a> titled â€œRestrict LDAP access via JNDIâ€ to fix the issue.</p><p>ğŸ“…<strong>2021 December 1st</strong>: Log4jÂ 2 exploit evidence as early as this day will later be <a href="https://twitter.com/eastdakota/status/1469800951351427073" target="_blank">found and tweeted about by Matthew Prince</a>, CEO of CloudFlare. But it wonâ€™t be mass exploited until after the public disclosure.</p><p>ğŸ“…<strong>2021 December 5</strong>: The <a href="https://github.com/apache/logging-log4j2/pull/608" target="_blank">pull request is merged</a> five days after Ralph Goers created it. Take into consideration that he states in his bio that â€œI work on Log4j and other open source projects in my spare timeâ€.</p><p>ğŸ“…<strong>2021 December 6</strong>: <a href="https://logging.apache.org/log4j/2.x/changes-report.html#a2.15.0" target="_blank">A new version of Log4jÂ 2 is released, 2.15.0</a>, which includes many improvements. This update fixes the <a href="/blog/intro-mitre-attack/#tactics">remote code execution</a>, but 7 days later will be proven vulnerable to a possible denial of service attack. <a href="https://logging.apache.org/log4j/2.x/#Mitigation" target="_blank">Among the changes</a>, there is a mention to:</p><blockquote class="quote"><p>In version 2.12.2 Log4jÂ 2 disables access to JNDI by default. Usage of JNDI in configuration now need to be enabled explicitly. Calls to the JndiLookup will now return a constant string. Also, Log4jÂ 2 now limits the protocols by default to only java. The message lookups feature has been completely removed.</p></blockquote><p>ğŸ“…<strong>2021 December 8</strong>: Alibabaâ€™s Chen reports to the Log4jÂ 2 team again that someone had just <a href="https://www.bloomberg.com/news/articles/2021-12-13/how-apache-raced-to-fix-a-potentially-disastrous-software-flaw" target="_blank">revealed the details of the vulnerability on a Chinese blogging platform</a>.</p><p class="alert alert-success vicente-opinion">My opinion is that maybe the author was somebody that saw the pull request. With all the caution Chen demonstrated I doubt it had something to do with him or people near him.</p><p>ğŸ“…<strong>2021 December 9</strong>: User <a href="https://www.cnblogs.com/suyu7" target="_blank">tangxiaofeng7</a> publishes publicly in GitHub <a href="https://github.com/tangxiaofeng7/CVE-2021-44228-Apache-Log4j-Rce/commit/6c209161477d048d32f3eb3e7b4f83abc9cf94a5" target="_blank">a proof of concept for exploiting the vulnerability</a> (I saw this repository as public, but it has later been deleted or made private; <a href="https://web.archive.org/web/20211213101824/https://github.com/tangxiaofeng7/CVE-2021-44228-Apache-Log4j-Rce/commits/main" target="_blank">some content is available on Archive.org</a>). The vulnerability is <a href="https://twitter.com/P0rZ9/status/1468949890571337731" target="_blank">being tweeted about</a> (the tweet has been deleted but <a href="https://web.archive.org/web/20211209230040/https://twitter.com/P0rZ9/status/1468949890571337731" target="_blank">a copy can be seen in Archive.org</a>). At 3:25PM the tweet has 89 retweets, 34 quotes, and 190 likes.</p><p class="alert alert-success vicente-opinion">As related information is only in Chinese, my lack of knowledge of that language, and limitations using Google Translate prevents me to investigate further.</p><p>ğŸ“…<strong>2021 December 10</strong>: The vulnerability in Log4jÂ 2 for <a href="/blog/intro-mitre-attack/#tactics">remote code execution</a> is <strong>published</strong> as <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" target="_blank">CVEâ€‘2021â€‘44228</a>, with a <strong>score of 10.0</strong> (the maximum value).</p><p>The <strong>same day</strong> <a href="https://appleinsider.com/articles/21/12/10/severe-flaw-in-java-library-impacts-icloud-amazon-steam-and-more" target="_blank">reports and news</a> start appearing continuously demonstrating <a href="https://twitter.com/_JohnHammond/status/1469255402290401285?s=20" target="_blank">very popular affected software</a>. GrayNoise network security provider tweets about <a href="https://twitter.com/GreyNoiseIO/status/1469376214079053833" target="_blank">the number of hosts exploiting the vulnerability increasing from 100 to 150 in several hours</a>. <a href="https://www.fastly.com/blog/digging-deeper-into-log4shell-0day-rce-exploit-found-in-log4j#what-we-ve-seen" target="_blank">Fastly reports</a> that in 24 hours of the report, the occurrences when scanning for the â€œjndi:â€ string that is employed in the exploit has spiked and that attackers are invested in researching different ways of exploiting the vulnerability, which is not true for all 0-day vulnerabilities that become public.</p><p><img data-proofer-ignore data-src="/blog/images/log4j_spike.png" alt="Exploit attempts for Log4j&nbsp;2 vulnerability in first 24 hours of disclouse" title="Exploit attempts for Log4j&nbsp;2 vulnerability in first 24 hours of disclouse" class="shadow" /> <em>Spike on queries using â€œjndi:â€ to compromise systems 24 hours after exploit published. <br /> Source: <a href="https://www.fastly.com/blog/digging-deeper-into-log4shell-0day-rce-exploit-found-in-log4j#what-we-ve-seen" target="_blank">Fastly</a></em></p><p class="alert alert-success vicente-opinion">Iâ€™m certain this will create a big campaign for hacker groups, not only trying to exploit this vulnerability, but seeking similar 0-days â€œgemsâ€ that may have been also missing in similar circumstances. First on Log4j (but I assume this library is going to get a lot of scrutiny), then for other popular similar libraries.</p><p>ğŸ“…<strong>2021 December 13</strong>: <a href="https://logging.apache.org/log4j/2.x/changes-report.html#a2.16.0" target="_blank">A new version released of Log4jÂ 2, v2.16.0</a> is released, which fixes some special cases that could result in a denial of service attack. It disables JNDI by default (fixing <a href="https://issues.apache.org/jira/browse/LOG4J2-3208" target="_blank">LOG4J2-3208</a>) and completely removes support for Message Lookups (fixing <a href="https://issues.apache.org/jira/browse/LOG4J2-3211" target="_blank">LOG4J2-3211</a>). <a href="https://logging.apache.org/log4j/2.x/#Mitigation" target="_blank">As explained on their website</a>:</p><blockquote class="quote"><p>In version 2.16.0 Log4j disables access to JNDI by default. JNDI lookups in configuration now need to be enabled explicitly. Also, Log4j now limits the protocols by default to only java, ldap, and ldaps and limits the ldap protocols to only accessing Java primitive objects. Hosts other than the local host need to be explicitly allowed. The message lookups feature has been completely removed.</p></blockquote><p>ğŸ“…<strong>2021 December 14</strong>: The related vulnerability <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046" target="_blank">CVEâ€‘2021â€‘45046</a> is reported that is <strong>fixed in Log4jÂ 2, v2.16.0</strong>. It is reported with a score value of just <strong>3.2</strong> (low), 7 days later will be increased to <strong>9.0</strong> (critical).</p><p>The same day <strong>Log4j 1.2</strong> is reported on <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4104" target="_blank">CVEâ€‘2021â€‘4104</a> with score 8.1 (high), as vulnerable to deserialization of untrusted data when the attacker has write access to the Log4j configuration. This project is at <em>end of life</em>, so no fix will be provided to this or other vulnerabilities that may arise.</p><p>ğŸ“…<strong>2021 December 16</strong>: A new vulnerability is also reported affecting <strong>Logback 1.2.7</strong> and previous versions, a project that forked from the original Log4j 1. Described at <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-42550" target="_blank">CVEâ€‘2021â€‘42550</a> with soce 6.6 (medium), using non-standard configuration files an untrusted deserialization of data may occur.</p><p>ğŸ“…<strong>2021 December 18</strong>: New release of <strong>Log4j 2.17.0</strong> is published that â€œprotect from infinite recursion in lookup evaluationâ€, the same day itâ€™s classified as <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45105" target="_blank">CVEâ€‘2021â€‘45105</a>.</p><p>ğŸ“…<strong>2021 December 22</strong>: Chinese Ministry of Information Technology (MIIT) said it will <a href="https://www.reuters.com/world/china/china-regulator-suspends-cyber-security-deal-with-alibaba-cloud-2021-12-22/">suspend collaboration for with Alibaba Cloud for not informing the Chinese government first</a> of the Log4j vulnerability, to be reassessed in six months. <a href="https://www.scmp.com/tech/big-tech/article/3160854/apache-log4j-bug-alibaba-cloud-vows-boost-compliance-after-chinese">The next day</a> Alibaba Cloud would provide an official statement towards improving its risk management and compliance, arguing that it did not fully comprehend the severity of the flaw at the time.</p><p class="alert alert-success vicente-opinion">This sets a precedent for Chinese tech companies to always inform first the Chinese government of any security flaw discovered in open source, or be punished. It gives the government of that country a heads up to fix first their own systems, exploit or collaborate as they like on vulnerabilities like this one.</p><p>ğŸ“…<strong>2021 December 28</strong>: Another release for <strong>Log4j 2, version 2.17.1</strong> with related <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44832" target="_blank">CVEâ€‘2021â€‘44832</a> with score <strong>6.6</strong>, for a possible remote code execution (RCE) what only can happen if adversaries can modify the libraryâ€™s configuration. It can be argued that <a href="https://snyk.io/blog/when-is-a-cve-not-a-cve/" target="_blank">this is just a misconfiguration</a> that could be handled by benchmarks, not a vulnerability. The eagerness to find new vulnerabilities in the library is showing.</p><h3 id="year-2022">2022 (next year)</h3><p>ğŸ“…<strong>2022 January 6</strong>: <a href="https://twitter.com/jfrog/status/1479186262770827270" target="_blank">Jfrog publishes information</a> on a vulnerability for the H2 database with <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42392" target="_blank">CVEâ€‘2021â€‘42392</a>, where an attacker may pass a JNDI driver name and URL leading to an LDAP or RMI server, causing <em>remote code execution</em>. The corresponding NIST NVD database entry with extended information, score, and vector is not available 2 days later.</p><h2 id="who-has-been-affected">Who has been affected?</h2><p><img data-proofer-ignore data-src="/blog/images/everyone.gif" alt="&quot;Everyone&quot; " title="Everyone" /></p><p>Not only the software you are developing may use one of those frameworks or the Log4jÂ 2 library directly, but also many other software products you use may do so.</p><p>As the main company behind Java, many <a href="https://www.oracle.com/security-alerts/alert-cve-2021-44228.html" target="_blank">Oracle</a> products are affected (you need to log into your Oracle account to see the full list).</p><p>5 days after publishing the first vulnerability, some of the companies/products reported as affected are <a href="https://github.blog/2021-12-13-githubs-response-to-log4j-vulnerability-cve-2021-44228/" target="_blank">GitHub Enterprise Server</a>, <a href="https://www.eukhost.com/blog/webhosting/cpanel-log4j-vulnerability-cve-2021-44228/" target="_blank">cPanel</a>, <a href="https://support.solarwinds.com/SuccessCenter/s/article/Server-Application-Monitor-SAM-and-the-Apache-Log4j-Vulnerability-CVE-2021-44228?language=en_US" target="_blank">SolarWinds SAM and DPA</a>, <a href="https://www.splunk.com/en_us/blog/bulletins/splunk-security-advisory-for-apache-log4j-cve-2021-44228.html" target="_blank">Splunk</a>, <a href="https://www.tableau.com/support/releases/server/2021.2.5" target="_blank">Tableau</a>, several <a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd" target="_blank">Cisco products</a>, <a href="https://www.esri.com/arcgis-blog/products/arcgis-enterprise/administration/arcgis-software-and-cve-2021-44228-aka-log4shell-aka-logjam/" target="_blank">ArcGIS Enterprise</a>, <a href="https://status.f-secure.com/incidents/sk8vmr0h34pd">F-Secure products</a>, <a href="https://www.goanywhere.com/cve-2021-44228-goanywhere-mitigation-steps" target="_blank">GoAnywhere</a>, <a href="https://www.graylog.org/post/graylog-update-for-log4j" target="_blank">GrayLog</a>, <a href="https://github.com/jitsi/security-advisories/blob/4e1ab58585a8a0593efccce77d5d0e22c5338605/advisories/JSA-2021-0004.md" target="_blank">Jitsi</a>, <a href="https://liferay.dev/blogs/-/blogs/log4j2-zero-day-vulnerability">Liferay</a>, <a href="https://discuss.newrelic.com/t/log4j-zero-day-vulnerability-and-the-new-relic-java-agent/170322" target="_blank">New Relic Java agent</a>, <a href="https://sec.okta.com/articles/2021/12/log4shell" target="_blank">Okta Radius and MFA agents</a>, <a href="https://cert-portal.siemens.com/productcert/pdf/ssa-661247.pdf" target="_blank">Siemens</a>, some <a href="https://www.sophos.com/en-us/security-advisories/sophos-sa-20211210-log4j-rce" target="_blank">Sophos</a> services, <a href="https://help.sumologic.com/Release-Notes/Collector-Release-Notes#december-11-2021-19-361-12" target="_blank">Sumo Logic</a>, <a href="https://www.suse.com/c/suse-statement-on-log4j-log4shell-cve-2021-44228-vulnerability/" target="_blank">Suse OpenStack Cloud</a>, <a href="https://community.tp-link.com/en/business/forum/topic/514452" target="_blank">TP-Link Omanda Controller</a>, some <a href="https://success.trendmicro.com/solution/000289940#Impact">Trend Micro</a> services, <a href="https://www.veritas.com/content/support/en_US/article.100052058" target="_blank">Veritas Netbackup</a>, many <a href="https://www.vmware.com/security/advisories/VMSA-2021-0028.html" target="_blank">VMWare</a> products. Some specific versions of <a href="https://discuss.elastic.co/t/apache-log4j2-remote-code-execution-rce-vulnerability-cve-2021-44228-esa-2021-31/291476" target="_blank">Elasticsearch and Logstash</a> are affected. <a href="https://confluence.atlassian.com/kb/faq-for-cve-2021-44228-1103069406.html" target="_blank">Some on-premise products of Atlassian</a> are partially affected (they use their own fork of Log4j). <a href="https://www.minecraft.net/en-us/article/important-message--security-vulnerability-java-edition" target="_blank">Minecraft Server</a> Java edition is affected, so now is when you know that it is real.</p><p>Other products like <a href="https://forum.gitlab.com/t/cve-2021-4428/62763" target="_blank">GitLab</a> or <a href="https://www.anaconda.com/blog/an-update-on-the-apache-log4j-vulnerability" target="_blank">Anaconda</a> donâ€™t use Log4j, and <a href="https://lists.apache.org/thread/lgbtvvmy68p0059yoyn9qxzosdmx4jdv" target="_blank">Apache Kafka uses Log4j 1</a>, so they claim they are not affected by this (not true, more on this on part II). <a href="https://www.jenkins.io/blog/2021/12/10/log4j2-rce-CVE-2021-44228/" target="_blank">Jenkins</a> isnâ€™t affected, but plugins installed in it may be, like <a href="https://github.com/jenkinsci/xray-connector-plugin/issues/53" target="_blank">Jenkins Xray Connector</a>.</p><p>Saas software providers like <a href="https://cloud.google.com/log4j2-security-advisory" target="_blank">Google Cloud</a>, <a href="https://aws.amazon.com/security/security-bulletins/AWS-2021-006/" target="_blank">AWS</a> and <a href="https://www.mongodb.com/blog/post/log4shell-vulnerability-cve-2021-44228-and-mongodb" target="_blank">MongoDB Atlas Search</a> also are known to have been using Log4j, and has been their responsibility to update, patch, or mitigate the problem.</p><p><a href="https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2/" target="_blank">Azure</a> announces that itâ€™s not using or directly providing Log4j, but <a href="https://github.com/microsoft/kafka-connect-cosmosdb/blob/0f5d0c9dbf2812400bb480d1ff0672dfa6bb56f0/CHANGELOG.md" target="_blank">Kafka Connect for Azure Cosmos DB</a> provided by Microsoft is affected. <a href="https://www.ibm.com/blogs/psirt/an-update-on-the-apache-log4j-cve-2021-44228-vulnerability/" target="_blank">IBM</a> and <a href="https://status.salesforce.com/generalmessages/826" target="_blank">Salesforce</a> seem to be still investigating the impact as December 14th, but at least <a href="https://www.ibm.com/support/pages/node/6525544" target="_blank">IBM Sterling Order Management</a> is affected.</p><p>Users claim that <a href="https://news.ycombinator.com/item?id=29499867" target="_blank">Steam</a> was vulnerable in its chat service, but I find no evidence, and no official announcement has been made. <a href="https://github.com/search?q=org%3ANetflix+CVE-2021-44228&amp;type=commits" target="_blank">Netflix</a> seems to have also patched the library. Apple and iCloud have been affected and <a href="https://twitter.com/chvancooten/status/1469340927923826691" target="_blank">changing an iPhone name</a> has been reported as triggering the vulnerability.</p><p>Insecure versions of Log4jÂ 2 were available on <a href="https://security-tracker.debian.org/tracker/CVE-2021-44228" target="_blank">Debian</a> and <a href="https://ubuntu.com/security/CVE-2021-44228" target="_blank">Ubuntu</a>, who have released updates.</p><p><a href="https://access.redhat.com/security/cve/cve-2021-44228" target="_blank">Red Hat Enterprise Linux</a> ships with Elasticsearch that uses a compromised version, but because of the use of the Java Security Manager, access to it is limited so the problem is moderate at most.</p><p><img data-proofer-ignore data-src="/blog/images/iphone_insecure.png" alt="alt_text" title="image_tooltip" /> <img data-proofer-ignore data-src="/blog/images/iphone_dnslog.png" alt="alt_text" title="image_tooltip" /> <em><a href="https://twitter.com/chvancooten/status/1469340927923826691" target="_blank">Changing an iPhone name</a> to trigger the vulnerability on Appleâ€™s servers.</em></p><p class="alert alert-warning"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> Do not use dnslog.cn por your tests! You are reporting to a third party website in China that you are vulnerable.</p><p>Kudos to <a href="https://twitter.com/SwitHak/status/1469467786997121029" target="_blank">SwitHak</a> for compiling an incredible <a href="https://gist.github.com/SwitHak/b66db3a06c2955a9cb71a8718970c592" target="_blank">list of links announcements from software vendors</a>, from which most of this information has been compiled.</p><p>Another great source of information you can use to check software and cloud provider services is <a href="https://github.com/NCSC-NL/log4shell/blob/main/software/README.md">this repository from the Nationaal Cyber Security Centrum</a>, that for each item lists if it is known if has been affected or not, and if a fix is available.</p><h2 id="cve-vulnerability-reports-affecting-log4j-2">CVE vulnerability reports affecting Log4j 2</h2><h3 id="cve-2021-44228">CVE-2021-44228</h3><ul><li>NVD database: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2021-44228</a><li>Date: ğŸ“…2021-12-10<li>CVSS severity v3.1: 10.0 Critical (<strong>maximum value</strong>)<li>Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H<li>Summary: <strong>Log4j 2.0-beta9 through 2.12.1 and 2.13.0 through 2.15.0</strong> JNDI features do not protect against attacker-controlled LDAP and other JNDI-related endpoints that result in an easy to execute <em>remote code execution</em>.</ul><h3 id="cve-2021-45046">CVE-2021-45046</h3><ul><li>NVD database: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2021-45046</a><li>Date: ğŸ“…2021-12-14<li>CVSS severity v3.1: 9.0 Critical (was previously reported as 3.2)<li>Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H<li>Summary: The previous fix in <strong>Log4j 2.15.0</strong> was incomplete and certain JNDI patterns could still be used for <em>remote code execution</em>.</ul><h3 id="cve-2021-45105">CVE-2021-45105</h3><ul><li>NVD database: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45105" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2021-45105</a><li>Date: ğŸ“…2021-12-18<li>CVSS severity v3.1: 5.9 Medium<li>Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H<li>Summary: The previous fix in <strong>Log4j versions 2.0-alpha1 through 2.16.0 (excluding 2.12.3 and 2.3.1)</strong> did not protect from uncontrolled recursion that can be exploited for a <em>denial of service</em> attack.</ul><h3 id="cve-2021-44832">CVE-2021-44832</h3><ul><li>NVD database: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44832" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2021-44832</a><li>Date: ğŸ“…12/28/2021<li>CVSS severity v3.1: 6.6 Medium<li>Vector: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H<li>Summary: <strong>Log4j2 versions 2.0-beta7 through 2.17.0 (excluding security fix releases 2.3.2 and 2.12.4)</strong> are vulnerable to <em>remote code execution</em> when a non-default configuration is used.</ul><p class="alert alert-info"><i class="fas fa-info-circle" aria-hidden="true"></i> Learn more about CVEs in my blog post <a href="/blog/what-is-a-cve" target="_blank">â€œWhat is a CVE?â€</a></p><p>Originally for the first CVE, the list of affected software was indicating just Log4j2 from 2.0-beta9 to 2.14.1. <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228#VulnChangeHistorySection" target="_blank">It has been updated including many more software packages</a>, and <strong>the list of reported affected software will keep growing</strong>.</p><p class="alert alert-success vicente-opinion">I bet it will become be the vulnerability with most software-affected references in the whole database. Also as the library is scrutinized, more previously unknown new vulnerabilities may be reported continuously.</p><p class="alert alert-warning"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> As the list of affected software in the vulnerability database keeps growing <strong>a vulnerability scan done today may not tell you all places where you are running software with a vulnerable version of Log4jÂ 2</strong>, so you should keep monitoring continuously your security posture to make sure you are not vulnerable.</p><h2 id="cve-vulnerability-reports-affecting-related-projects">CVE vulnerability reports affecting related projects</h2><h3 id="cve-2021-42392">CVE-2021-42392</h3><ul><li>MITRE database: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42392" target="_blank">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42392</a><li>Date: ğŸ“…10/14/2021<li>NVD database (awaiting analysis): <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-42392" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2021-42392</a><li><a href="https://github.com/cloudsecurityalliance/gsd-database/blob/main/2022/1000xxx/GSD-2022-1000006.json" target="_blank">Global Security Database (GSD) entry</a> from Cloud Security Alliance, published on 8th of January.<li>CVSS severity v3.1: 10 (from GSD)<li>Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:H/RL:O/RC:C (from GSD)<li>Summary: On <strong>H2 database</strong> versions prior to version 2.0.206, an attacker may pass as a database parameter a JNDI driver name with a URL leading to an LDAP or RMI servers, causing <em>remote code execution</em>, for example through the H2 Console.</ul><h3 id="cve-2021-4104">CVE-2021-4104</h3><ul><li>NVD database: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4104" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2021-4104</a><li>Date: ğŸ“…12/14/2021<li>CVSS severity v3.1: 8.6 High<li>Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H<li>Summary: <strong>Log4j 1.2</strong> when configured to use JMSAppender (non-default setup) is vulnerable to deserialization of untrusted data. No fix will be provided because the product is at end of life (migrate to latest Log4j 2).</ul><h3 id="cve-2021-42550">CVE-2021-42550</h3><ul><li>NVD database: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4104" target="_blank">https://nvd.nist.gov/vuln/detail/CVE-2021-42550</a><li>Date: ğŸ“…12/16/2021<li>CVSS severity v3.1: 6.6 Medium<li>Vector: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H<li>Summary: <strong>Logback 1.2.7</strong> and prior versions, an attacker with the required privileges to edit configurations files could craft a malicious configuration allowing to execute arbitrary code loaded from LDAP servers.</ul><h2 id="log4j-2-maintainers">Log4j 2 maintainers</h2><p><img data-proofer-ignore data-src="/blog/images/maintainer_nebraska.png" alt="XKCD strip 2346 showing how lots of components depends of a single piece maintained by someone in his spare time" title="XKCD strip 2346 showing how lots of components depends of a single piece maintained by someone in his spare time" /> <em>Source: <a href="https://xkcd.com/2347/" target="_blank">XKCD comic 2347</a></em></p><p>Log4j 2 was created by <a href="https://www.ralphgoers.com/post/why-was-log4j-2-created" target="_blank">Ralph Goers</a>. The <a href="https://github.com/apache/logging-log4j2/graphs/contributors" target="_blank">most active people committing to the GitHub repository</a> now are him, <a href="https://github.com/garydgregory" target="_blank">Gary Gregory</a>, <a href="https://github.com/remkop" target="_blank">Remko Popma</a>, and <a href="https://github.com/jvz" target="_blank">Matt Sicker</a>.</p><p>Just before the exploit was published, <a href="https://twitter.com/MrDanack/status/1469524817946816515" target="_blank">Ralph had only 7 sponsors</a> on GitHub, on December 15 <a href="https://github.com/sponsors/rgoers" target="_blank">he had 78 and going up, but still, none of them are companies</a>. The rest of the developers with sponsorship enabled had that day a combined amount of 3 sponsors.</p><p>In Ralphâ€™s words that you can read on <a href="https://github.com/sponsors/rgoers" target="_blank">his GitHub bio</a>:</p><blockquote class="quote"><p>I currently have a full time job as a Software Architect. I work on Log4j and other open source projects in my spare time and so I typically work on those issues that are of most interest to me. <strong>I have always dreamed of working on open source full time and would love your support to enable that to happen</strong>.</p></blockquote><p>As you can read on the <a href="https://logging.apache.org/log4j/2.x/support.html" target="_blank">Apache Log4j website</a>:</p><blockquote class="quote"><p>The Apache Software Foundation does not employ individuals to develop and support any of its projects. The individuals who contribute to Apache projects do it either as part of specific tasks assigned to them by their employer, on their own initiative to benefit their employer or on their own free time. While some projects at the ASF have employees who are specifically paid to work on the project, <strong>none of the committers to any of the Logging Services projects are directly paid to work on them</strong>.</p></blockquote><p class="alert alert-success vicente-opinion">I think they have done an excellent job reviewing, patching, and publishing fast updates to the vulnerabilities.</p><p>You can sponsor maintainers of Log4j with a one-time donation, or on a recurring monthly basis on their GitHub profile. <strong>If you can get your company to sponsor them, you will contribute to keep open source safer for you, your company, and everybody else</strong>. The maintainers that accept sponsorship are:</p><ul><li><a href="https://github.com/rgoers#sponsors" target="_blank">Ralph Goers</a><li><a href="https://github.com/garydgregory#sponsors" target="_blank">Gary Gregory</a><li><a href="https://github.com/jvz#sponsors" target="_blank">Matt Sicker</a><li><a href="https://github.com/vy#sponsors" target="_blank">Volkan YazÄ±cÄ±</a></ul><h2 id="thanks-for-the-help">Thanks for the help</h2><p>Thank you to all referenced sources for their great job sharing information very early since the beginning of the situation.</p><p>Thanks to <a href="https://twitter.com/Quemandoacromo" target="_blank">@Quemandoacromo</a> that after reading the article, sent me a link to Archive.org for the removed repository, and another link for the <a href="https://github.com/NCSC-NL" target="_blank">Nationaal Cyber Security Centrum</a> list of affected software.</p><h2 id="conclusion">Conclusion</h2><p>The Log4j 2 vulnerabilities discovered on the 10th of December 2021 have existed since many years ago and have caused a huge snowball of insecurities affecting your project, other open and closed source software, as well as cloud services.</p><p>The maintainers of that library work on it in their spare time without official support from any company but have been able to act very fast to publish fixes for the problems.</p><p>Despite this, the situation right now is very uncertain, and many malicious campaigns will surely go rampant.</p><p>To learn more about the technical details and a proof of concept using Kubernetes, jump to article <a href="/blog/log4j-part-ii/">part II: Kubernetes POC</a>.</p><p>If there is some information I missed in this article, or you just want to chat with me, <a href="https://twitter.com/v1z3n" target="_blank"><i class="fab fa-twitter" style="color:#1DA1F2;" aria-hidden="true"></i> let me know</a>.</p><p>And if you found this information extremely useful to you, why not let others know? <a href="https://twitter.com/share?url=https://vicenteherrera.com/log4j-part-i/&amp;title=Log4j+2+vulnerabilities%2C+part+I%3A+History" target="_blank"><i class="fab fa-twitter" style="color:#1DA1F2;" aria-hidden="true"></i> Share it in a tweet</a>, or <a href="https://ko-fi.com/R5R77UF84" target="_blank">invite me to coffee</a>!</p><hr /><p><em>Vicente Herrera is a software engineer working on cloud native cybersecurity (cloud, containers, Kubernetes).<br /> His latest job is cybersecurity specialist at <a href="https://control-plane.io" target="_blank">Control Plane</a>, and previously was Product Manager at <a href="https://sysdig.com" target="_blank">Sysdig</a>.<br /> He is the published author of <a href="https://www.oreilly.com/library/view/building-intelligent-cloud/9781492052319/" target="_blank">Building Intelligent Cloud Application</a> (Oâ€™Reilly, 2019) about using serverless and machine learning services with Azure.<br /> He has been involved in several research projects for using AI on healthcare and automatic code generation.</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/security/'>Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/cve/" class="post-tag no-text-decoration" >CVE</a> <a href="/blog/tags/log4j/" class="post-tag no-text-decoration" >Log4j</a> <a href="/blog/tags/h2/" class="post-tag no-text-decoration" >H2</a> <a href="/blog/tags/logback/" class="post-tag no-text-decoration" >Logback</a> <a href="/blog/tags/vulnerability/" class="post-tag no-text-decoration" >vulnerability</a> <a href="/blog/tags/remote-code-execution/" class="post-tag no-text-decoration" >remote code execution</a> <a href="/blog/tags/jndi/" class="post-tag no-text-decoration" >JNDI</a> <a href="/blog/tags/cve-2021-44228/" class="post-tag no-text-decoration" >CVE-2021-44228</a> <a href="/blog/tags/cve-2021-45046/" class="post-tag no-text-decoration" >CVE-2021-45046</a> <a href="/blog/tags/cve-2021-45105/" class="post-tag no-text-decoration" >CVE-2021-45105</a> <a href="/blog/tags/cve-2021-44832/" class="post-tag no-text-decoration" >CVE-2021-44832</a> <a href="/blog/tags/cve-2021-42392/" class="post-tag no-text-decoration" >CVE-2021-42392</a> <a href="/blog/tags/cve-2021-4104/" class="post-tag no-text-decoration" >CVE-2021-4104</a> <a href="/blog/tags/cve-2021-42550/" class="post-tag no-text-decoration" >CVE-2021-42550</a> <a href="/blog/tags/cve-2015-4902/" class="post-tag no-text-decoration" >CVEâ€‘2015â€‘4902</a> <a href="/blog/tags/log4shell/" class="post-tag no-text-decoration" >log4shell</a> <a href="/blog/tags/rce/" class="post-tag no-text-decoration" >RCE</a> <a href="/blog/tags/report/" class="post-tag no-text-decoration" >report</a> <a href="/blog/tags/history/" class="post-tag no-text-decoration" >history</a> <a href="/blog/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/blog/tags/cybersecurity/" class="post-tag no-text-decoration" >cybersecurity</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Log4j 2 vulnerabilities, part I: History - The Vlog&url=https://vicenteherrera.com/blog/log4j-part-i/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Log4j 2 vulnerabilities, part I: History - The Vlog&u=https://vicenteherrera.com/blog/log4j-part-i/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://vicenteherrera.com/blog/log4j-part-i/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/log4j-part-iii/">Log4j 2 vulnerabilities, part III: Prevention, mitigation and fixing</a><li><a href="/blog/log4j-part-i/">Log4j 2 vulnerabilities, part I: History</a><li><a href="/blog/log4j-part-ii/">Log4j 2 vulnerabilities, part II: Kubernetes POC</a><li><a href="/blog/what-is-a-cve/">What is a CVE?</a><li><a href="/blog/first-post/">Hi everybody... welcome to my blog!</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/cybersecurity/">cybersecurity</a> <a class="post-tag" href="/blog/tags/cve/">CVE</a> <a class="post-tag" href="/blog/tags/security/">security</a> <a class="post-tag" href="/blog/tags/cve-2021-44228/">CVE-2021-44228</a> <a class="post-tag" href="/blog/tags/cve-2015-4902/">CVEâ€‘2015â€‘4902</a> <a class="post-tag" href="/blog/tags/log4j/">Log4j</a> <a class="post-tag" href="/blog/tags/log4shell/">log4shell</a> <a class="post-tag" href="/blog/tags/rce/">RCE</a> <a class="post-tag" href="/blog/tags/remote-code-execution/">remote code execution</a> <a class="post-tag" href="/blog/tags/vulnerability/">vulnerability</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/log4j-part-iii/"><div class="card-body"><picture> <source srcset="/blog/images/featured/closed_windows.jpg_360 360w, /blog/images/featured/closed_windows.jpg_720 2x"> <source srcset="/blog/images/featured/closed_windows.jpg_720 720w, /blog/images/featured/closed_windows.jpg 2x"> <source srcset="/blog/images/featured/closed_windows.jpg"> <img class="thumbnail img-fluid" src="/blog/images/featured/closed_windows.jpg" alt="Log4j 2 vulnerabilities, part III: Prevention, mitigation and fixing"> </picture><br /> <span class="timeago small" >Jun 27<i class="unloaded">2023-06-27T23:45:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Log4j 2 vulnerabilities, part III: Prevention, mitigation and fixing</h3><div class="text-muted small"><p> Wow, more than a year without writing anything more, and even leaving a three-part blog post unfinishedâ€¦ So what happened? Well, I started a new job, which requires a lot of focus as the beginning...</p></div></div></a></div><div class="card"> <a href="/blog/what-is-a-cve/"><div class="card-body"><picture> <source srcset="/blog/images/featured/cyberpunk-cve.png_360 360w, /blog/images/featured/cyberpunk-cve.png_720 2x"> <source srcset="/blog/images/featured/cyberpunk-cve.png_720 720w, /blog/images/featured/cyberpunk-cve.png 2x"> <source srcset="/blog/images/featured/cyberpunk-cve.png"> <img class="thumbnail img-fluid" src="/blog/images/featured/cyberpunk-cve.png" alt="What is a CVE?"> </picture><br /> <span class="timeago small" >Dec 6, 2021<i class="unloaded">2021-12-06T05:20:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>What is a CVE?</h3><div class="text-muted small"><p> You are playing Cyberpunk 2077, and on the introductory mission, you have to steal a car. After using an electronic tool first to open its door, you get inside, and while the hijack takes place, a ...</p></div></div></a></div><div class="card"> <a href="/blog/intro-mitre-attack/"><div class="card-body"><picture> <source srcset="/blog/images/featured/mitre-attack-logo.png_360 360w, /blog/images/featured/mitre-attack-logo.png_720 2x"> <source srcset="/blog/images/featured/mitre-attack-logo.png_720 720w, /blog/images/featured/mitre-attack-logo.png 2x"> <source srcset="/blog/images/featured/mitre-attack-logo.png"> <img class="thumbnail img-fluid" src="/blog/images/featured/mitre-attack-logo.png" alt="Introduction to MITRE ATT&CK"> </picture><br /> <span class="timeago small" >Nov 25, 2021<i class="unloaded">2021-11-25T19:34:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Introduction to MITRE ATT&CK</h3><div class="text-muted small"><p> When you start working on cybersecurity, you for sure start seeing references to things like privilege escalation, lateral movement, or exfiltration continuously. As categories for security tools, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/what-is-a-cve/" class="btn btn-outline-primary" prompt="Older"><p>What is a CVE?</p></a> <a href="/blog/log4j-part-ii/" class="btn btn-outline-primary" prompt="Newer"><p>Log4j 2 vulnerabilities, part II: Kubernetes POC</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://twitter.com/v1z3n">Vicente Herrera</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">CC BY.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/blog/tags/cybersecurity/">cybersecurity</a> <a class="post-tag" href="/blog/tags/cve/">CVE</a> <a class="post-tag" href="/blog/tags/security/">security</a> <a class="post-tag" href="/blog/tags/cve-2021-44228/">CVE 2021 44228</a> <a class="post-tag" href="/blog/tags/cve-2015-4902/">CVEâ€‘2015â€‘4902</a> <a class="post-tag" href="/blog/tags/log4j/">Log4j</a> <a class="post-tag" href="/blog/tags/log4shell/">log4shell</a> <a class="post-tag" href="/blog/tags/rce/">RCE</a> <a class="post-tag" href="/blog/tags/remote-code-execution/">remote code execution</a> <a class="post-tag" href="/blog/tags/vulnerability/">vulnerability</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/blog/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-3J0T6C6HWL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-3J0T6C6HWL'); }); </script>
